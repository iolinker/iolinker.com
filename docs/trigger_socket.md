

## Indroduction

By listening to the app through Socket, you can respond to udp and tcp client requests and trigger workflow execution.

<iframe width="800" height="600" src="https://www.youtube.com/embed/ro24OHsGIEc" frameborder="0" allowfullscreen></iframe>

## How To Use

![image-20230816131326741](./img/socket-1.png)

### 1. Select [Socket Type]

- UDP
- TCP



### 2. Receive Events (TCP)

If you choose tcp server to monitor, you can choose the type of event to respond to.

- Connect

  When the TCP client connects to the server, the **Connect** event will be generated to trigger workflow execution.

- Data

  Every time the TCP client sends data to the server, a **Data** event will be generated to trigger workflow execution.

- Close

  When the TCP client close the connection to server, the **Close** event will be generated to trigger workflow execution.

![image-20230816220019263](./img/socket-7.png)

### 3. Set [Host]

Set the host address that the socket server listens to.



### 4. Set [Port]

Set the port bound to the socket server.



### 5. Set [Debug]

[Debug] is used to simulate the parameters sent by socket clients, which is for easy debugging.

<img src="./img/socket-2.png" alt="image-20230816131506696" style="zoom:33%;" />



### 6. Enable socket server

![image-20230816131705952](./img/socket-3.png)



### 7.Socket server process

View the listening port through the **[netstat]** command.

```shell
netstat -anp|grep [port]
```

![image-20230816215028238](./img/socket-4.png)

![image-20230816220928312](./img/socket-8.png)



### 8. [UDP Client] Send data to udp socket server

First, create the udp socket workflow and enable it.

![image-20230816221712162](./img/socket-15.png)

![image-20230816221021174](./img/socket-9.png)

udp_client.py

```python
import socket

msgFromClient       = "Hello UDP Server"
bytesToSend         = str.encode(msgFromClient)
serverAddressPort   = ("127.0.0.1", 9999)
bufferSize          = 1024

UDPClientSocket = socket.socket(family=socket.AF_INET, type=socket.SOCK_DGRAM)
UDPClientSocket.sendto(bytesToSend, serverAddressPort)
```

Every time data is sent to the udp server, the workflow execution will be triggered.

![image-20230816215553772](./img/socket-5.png)



Data sent from udp client.

<img src="./img/socket-6.png" alt="image-20230816215629170" style="zoom: 33%;" />



### 9. [TCP Client] Send data to tcp socket server

First, create the tcp socket workflow and enable it.

![image-20230816221650104](./img/socket-14.png)

![image-20230816220928312](./img/socket-8.png)

tcp_client.py

```python
import socket
import time

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ROBOT_IP= "0.0.0.0"
ROBOT_PORT = 9999
client.connect((ROBOT_IP,ROBOT_PORT))
cmd = 'Hello TCP Server'
client.send(bytes(cmd+'\0','ascii'))
```

The following are the three execution records generated by the Connect, Data, and Close events triggered by the TCP client.

![image-20230816221137648](./img/socket-10.png)



> Connect Event

<img src="./img/socket-11.png" alt="image-20230816221458066" style="zoom:33%;" />

> Data Event

<img src="./img/socket-12.png" alt="image-20230816221538159" style="zoom:33%;" />

> Close Event

![image-20230816221614877](./img/socket-13.png)